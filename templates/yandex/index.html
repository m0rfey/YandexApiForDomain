{% extends 'yandex/base.html' %}
{% block content %}
    <script type="text/javascript">


    </script>



{# Add email #}
    <div class="row">
    <hr>
    <div class="btn-group" role="group">
        <input type="button" class="btn btn-primary" value="Добавить почтовый ящик" data-toggle="modal" data-target="#add_email">
        <input type="button" class="btn btn-primary" value="Добавить домен" data-toggle="modal" data-target="#add_email">
    </div><hr>

    <!-- Modal -->
    <div class="modal fade" id="add_email" tabindex="-1" role="dialog" aria-labelledby="AddEmail">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="AddEmail">Новый почтовый ящик</h4>
          </div>
            <form action="{% url 'reg_user_token' %}" method="post" id="start">
                {% csrf_token %}
                <div class="modal-body">
                  <table>
                      <tr>
                          <td class="add_email">
                          <div class="input-group">
                              {{ add_e_form.login }}
                               <span class="input-group-addon" id="basic-addon2">{{ add_e_form.login.label }}</span>
                          </div>
                              </td>
{#                          <td class="add_email">{{ add_e_form.login }}</td>#}
{#                          <td class="add_email">{{ add_e_form.login.label }}</td>#}
                          <td class="add_email"></td>
                          <td class="add_email">{{ add_e_form.is_forward }}{{ add_e_form.is_forward.label }}</td>

                      </tr>
                      <tr>
                          <td class="add_email">{{ add_e_form.passw1 }}</td>
                          <td class="add_email"></td>
                          <td class="add_email">{{ set_forward.email_forward }}</td>
                      </tr>
                      <tr>
                          <td class="add_email">{{ add_e_form.passw2 }}</td>
                          <td class="add_email"></td>
                          <td class="add_email">{{ set_forward.is_copy }}{{ set_forward.is_copy.label }}</td>
                      </tr>
                  </table>
                </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Закрыть</button>
                <button type="submit" class="btn btn-primary" data-toggle="form" data-target="#start">Создать</button>
              </div>
          </form>
        </div>
      </div>
    </div>
</div>
{# End Add email #}

{# Delete Email #}
<div class="row">
    <div class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" id="is_delete">
      <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="AddEmail">Удаление почтового ящика</h4>
          </div>

                <div class="modal-body">
                        <p> Вы хотите удалить почтовый ящик?</p>
                        <p id="log"></p>

                </div>
                <div class="modal-footer" id = "modal-footer"></div>
        </div>
      </div>
    </div>
</div>
{# End Delete Email #}

{# Set Forward Email #}
<div class="row">
    <div class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" id="set_forward">
      <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="SetForward">Добавлене переадресации</h4>
          </div>
            <form action="" name="SetForw" method="POST" id="set_forward_form">
                {% csrf_token %}
                <div class="modal-body">
                    <p>Вы добавляете переадресацию для</p>
                    <p id="login_forward"></p>
                    {{ set_forward.login }}
                    {{ set_forward.email_forward }}
                    {{ set_forward.is_copy }}
                    {{ set_forward.is_copy.label }}
                </div>
                <div class="modal-footer" id = "modal-footer-forward"></div>
            </form>
        </div>
      </div>
    </div>
</div>
{# End Set Forward Email #}

{# Edit user #}
    <div class="row">
        <div class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" id="edit_user">
      <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="EditUser">Редактирование пользователя</h4>
          </div>
            <form action="{% url 'edit_user' %}" name="EditUserForm" method="POST" id="edit_user_form">
                {% csrf_token %}
                <div class="modal-body">
                    <div id="login" name="login"></div>
                    {{ edit_user.as_p }}
                </div>
                <div class="modal-footer" id = "modal-footer-forward">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Закрыть</button>
                    <button type="submit"  onclick="" class="btn btn-primary" data-toggle="form" data-target="#edit_user_form">Сохранить</button>
                </div>
            </form>
        </div>
      </div>
    </div>
    </div>
{# End Edit user #}

<div class="row">
<table id="example" class="table table-striped table-bordered" cellspacing="0" width="100%">
  <thead>
    <tr>
       <th>ID</th>
        <th>Логин</th>
        <th>Ативен</th>
        <th>Рассылка</th>
        <th>Переадресация</th>
        <th>ID переадресации</th>
        <th>Копия</th>
        <th>Переадресация на</th>
        <th></th>
        <th></th>
        <th></th>
    </tr>
  </thead>
  <tbody>
   {% for account in accounts %}
     <tr>
        <td>{{ account.uid }}</td>
        <td>{{ account.logins }}</td>
        <td>{{ account.enabled }}</td>
        <td>{{ account.maillist }}</td>
       {% if account.forward %}
           <td>
               {% for foo in account.forward %}
                   {{ foo }}<br>
               {% endfor %}
           </td>

           <td>
               {% for foo in account.id_fw %}
                     {{ foo }}<a href="{% url 'del_forward' account.logins foo %}"> Удалить</a><br>
               {% endfor %}
            </td>
            <td>
            {% for foo in account.copy %}
                    {{ foo }}<br>
            {% endfor %}
            </td>
            <td>
            {% for foo in account.filter_param %}
                {{ foo }}<br>
            {% endfor %}
            </td>
       {% else %}
           <td></td>
           <td></td>
           <td></td>
           <td></td>
       {% endif %}
       <td><a href="#" onclick="EditUser(this)" data-toggle="modal" data-target="#edit_user" rel="{{ account.uid }}">Редактировать</a></td>
       <td><a href="#" onclick="Delete_email(this)" data-toggle="modal" data-target="#is_delete" rel="{{ account.logins }}">Удалить ящик</a></td>
       <td><a href="#" onclick="SetForward(this)" data-toggle="modal" data-target="#set_forward" rel="{{ account.logins }}">Добавить переадресацию</a></td>
    </tr>
   {% endfor %}
  </tbody>
</table>

</div>
{% endblock %}


